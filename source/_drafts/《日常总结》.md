# 记录平常开发时零碎的知识

#### RxJava、RxAndroid网络请求与单元测试

在RxJava切换线程时由于单元测试中不存在`AndroidSchedulers.mainThread()`,因此单元测试时不会跑入，解决办法：

``` Java
// 将Android主线程mock为普通线程
@PrepareForTest({ AndroidSchedulers.class})
...

@Before
void setUp() {
	PowerMockito.mockStatic(AndroidSchedulers.class);
	BDDMockito.given(AndroidSchedulers.mainThread()).willReturn(Schedulers.io());
}
```

还有一点需要注意的是单元测试几乎百分百会在网络请求结束前结束导致没有结果，解决方法可以是使用RxJava提供的TestObserver，也可以将所有线程切换都mock为在当前线程进行，或者简单粗暴地`Thread.sleep(3000)`。